# **2420- Assignment-3 part 1**
## Automating System Information with Bash and Nginx

## **Introduction**

The purpose of this assignment is to write a Bash script that will generate an index.html file and configure it to run daily at 5:00 using a systemd system and timer. The HTML document generated by this script will be Hosted on a Nginx web server running on your Arch Linux droplet, with a ufw firewall configured to enhance server security

## **Table of Contents**
1. **Task 1:** Setting up a system user with directories
2. **Task 2:** Creating and configuring systemd service and scripts
3. **Task 3:** Configuring Nginx
4. **Task 4:** Installing and configuring ufw for ssh and HTTP
5. **Task 5:** Verifying that the System Information page is working properly


## **Task One:** Setting up user and directories

> What is the benefit of creating a system user for this task?


The reason we want to create a system user instead of using a regular user or root is to enhance security and keep thefunctions isolated from regular user activities. It decreases the risk of accidental or malicious system wide chages.


**Step 1:** Creating a new user

Type the following command:

```
sudo useradd -r -d /var/lib/webgen -s /usr/sbin/nologin webgen
```
**Explanation:**
- `-r`: This will create a system account
- `-d`: This specifies the home directory
- `-s /usr/sbin/nologin`:  This specifies the non-login shell
  

**Step 2:** Create home directory

Next, since we don't have a home directory yet, we want to create one using this command

```
sudo mkdir -p /var/lib/webgen
```


**Step 3:** Create subdirectory /bin

This command is used to create subdirectories within the webgen directory

```
sudo mkdir -p /var/lib/webgen/bin
```


**Step 4:** Create subdirectory /HTML

This command is used to create subdirectories within the webgen directory

```
sudo mkdir -p /var/lib/webgen/HTML
```


**Step 5:** Cloning the generated index script

Our next step is setting up the generated index script.
This can be done by cloning it from the sourcehut repository with this command:

```
git clone https://git.sr.ht/~nathan_climbs/2420-as2-start
```


**Step 6:** Moving the generated script into the correct directory

Since we cloned the generated script into the home directory, we want to move it into the appropriate /var/lib/webgen/bin/ directory using:

```
sudo mv 2420-as2-start/generate_index /var/lib/webgen/bin/
```


**Step 7:** Give executable permissions to script

```
sudo chmod +x /var/lib/webgen/bin/generate_index
```



**Step 8:** Set Ownership

```
sudo chown -R webgen:webgen /var/lib/webgen
```


## **Task Two:** Creating and configuring systemd service and scripts



**Step 1:** Create the generate-index.service file

The first step of this task is to use the command below to create the generate-index.service file 

```
sudo nvim /etc/systemd/system/generate-index.service
```

Once you are inside the nvim text editor, you will want to type the following content inside of it:

```
[Unit]
Description=Generate Index Service File

[Service]
Type=simple
User=webgen
Group=webgen
ExecStart=/var/lib/webgen/bin/generate_index
```

**Explanation:**
- **[Unit]:** Describes the service 
- **[Service]:** Defines how the service should behave when started
  

**Step 2:** Create the generate-index.timer file

The next step is to use the command below to create the generate-index.timer file

```
sudo nvim /etc/systemd/system/generate-index.timer
```

Once you are inside the nvim text editor, you will want to add the following content inside of it:

```
[Unit]
Description=Timer for Generate Index Service

[Timer]
OnCalendar=*-*-* 05:00:00
Unit=generate-index.service
Persistent=true

[Install]
WantedBy=timers.target
```


**Explanation:**
- **[Timer]:** This specifies the schedule of the timer 
- **[Install]:** This Specifies how timer works with systemd


**Step 3:**  Start Timer

This command starts the generate-index.timer right away.

```
sudo systemctl start generate-index.timer
```


**Step 4:** Enable timer

This command configures the timer to start automatically when the system is booted.

```
sudo systemctl enable generate-index.timer
```


**Step 5:** Timer status

Once the timer has been set up and started, we want to confirm the status of the timer to make sure that everything is working correctly.

to verify that the timer is active and that the service runs successfully,

Run this command:

```
systemctl status generate-index.timer
```

The output should look like this:

**img**


> [!NOTE]
> run `systemctl status generate-index.service` to check the status of the service


**Step 6:** View logs

To view the logs of the generated-index.service, run this command:

```
sudo journalctl -u generate-index.service
```




